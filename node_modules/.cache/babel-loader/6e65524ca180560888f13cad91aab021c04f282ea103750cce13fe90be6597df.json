{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\gary\\\\Downloads\\\\html\\\\src\\\\components\\\\Momi.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport * as XLSX from 'xlsx';\nimport './Momi.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Momi = () => {\n  _s();\n  const [formattedData, setFormattedData] = useState([]);\n  const [startNumber, setStartNumber] = useState('');\n  const [offset, setOffset] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [errors, setErrors] = useState({});\n  const [successMessage, setSuccessMessage] = useState('');\n  const [dragActive, setDragActive] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const fileInputRef = useRef(null);\n  const outputRef = useRef(null);\n  const [previewData, setPreviewData] = useState(null);\n  useEffect(() => {\n    let interval;\n    if (loading) {\n      interval = setInterval(() => {\n        setProgress(prev => Math.min(prev + 10, 90));\n      }, 200);\n    }\n    return () => {\n      clearInterval(interval);\n      if (!loading && progress < 100) {\n        setProgress(100);\n        setTimeout(() => setProgress(0), 500);\n      }\n    };\n  }, [loading, progress]);\n  useEffect(() => {\n    if (errors.file || errors.startNumber || errors.offset) {\n      const timer = setTimeout(() => setErrors({}), 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [errors]);\n  useEffect(() => {\n    if (startNumber && offset) {\n      validateInputs();\n    }\n  }, [startNumber, offset, validateInputs]);\n  const validateInputs = useCallback(() => {\n    const newErrors = {};\n    if (!fileInputRef.current.files.length) {\n      newErrors.file = 'Ë´ãÈÅ∏Êìá‰∏ÄÂÄã Excel Ê™îÊ°à„ÄÇ';\n    }\n    if (!Number.isInteger(Number(startNumber)) || startNumber < 1) {\n      newErrors.startNumber = 'Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÊ≠£Êï¥Êï∏„ÄÇ';\n    }\n    if (!Number.isInteger(Number(offset)) || offset < 0) {\n      newErrors.offset = 'Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÈùûË≤†Êï¥Êï∏„ÄÇ';\n    }\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  }, [startNumber, offset]);\n  const handleDrag = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\n      setDragActive(true);\n    } else if (e.type === \"dragleave\") {\n      setDragActive(false);\n    }\n  };\n  const handleDrop = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      const file = e.dataTransfer.files[0];\n      const isValidFileType = fileName => ['.xlsx', '.xls', 'application/vnd.ms-excel', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'].some(ext => fileName.endsWith(ext) || file.type.includes(ext));\n      if (isValidFileType(file.name)) {\n        fileInputRef.current.files = e.dataTransfer.files;\n        setErrors(prev => ({\n          ...prev,\n          file: ''\n        }));\n      } else {\n        setErrors(prev => ({\n          ...prev,\n          file: 'Ë´ã‰∏äÂÇ≥ Excel Ê™îÊ°à (.xlsx Êàñ .xls)'\n        }));\n      }\n    }\n  };\n  const memoizedProcessor = useCallback((jsonData, startRowIndex) => {\n    const processRow = (row, index) => {\n      const currentNumber = parseInt(startNumber) + index;\n      return `üêçüêçÊñ∞Âπ¥Âø´Ê®Çü•∞üéÜüéÜüéÜüéÜ\\n\\nÁ¨¨${currentNumber}‰ΩçÊäïÁ®ø‰∫∫ÂöüÂï¶ÔΩû\\nÂêçÂ≠óÔºö${row[1] || 'N/A'}\\nÂπ¥ÈΩ°Ôºö${row[2] || 'N/A'}\\nË∫´È´òÔºö${row[3] || 'N/A'}\\n\\nÊèèËø∞Ëá™Â∑≤Ôºö${row[4] || 'N/A'}\\n\\nË¶ÅÊ±ÇÔºö${row[5] || 'N/A'}\\n\\nËÅØÁµ°ÊñπÂºèÔºö${row[6] || 'N/A'}\\n\\nÂ¶ÇÊûúÊúâÁ∑£‰∫∫ÊÉ≥Ë™çË≠òÁÑ°ÁïôtgÊó¢ÊäïÁ®ø‰∫∫ÔºåÂèØ‰ª•dmÂπ≥Âè∞ÁöÑÔºÅüôäüôäüôäüôäüôä\\nÊäïÁ®ølink‰øÇ‰∏ªÈ†Åüß®Â§ßÂÆ∂Èö®ÊÑèÊäïÁ®øüéê\\n\\n`;\n    };\n    return jsonData.slice(startRowIndex).map((row, index) => processRow(row, index));\n  }, [startNumber]);\n  const handleProcess = async () => {\n    if (!validateInputs()) return;\n    setLoading(true);\n    setSuccessMessage('');\n    setProgress(0);\n    try {\n      const file = fileInputRef.current.files[0];\n      const data = await readFile(file);\n      const workbook = XLSX.read(data, {\n        type: 'array'\n      });\n      const sheetName = workbook.SheetNames[0];\n      const worksheet = workbook.Sheets[sheetName];\n      const jsonData = XLSX.utils.sheet_to_json(worksheet, {\n        header: 1\n      });\n      const startRowIndex = parseInt(startNumber) + parseInt(offset) - 1;\n      if (startRowIndex >= jsonData.length) {\n        setErrors({\n          file: `Ëµ∑ÂßãÊï∏Â≠óÂä†ÂÅèÁßªÂÄºÊåáÂêëÁöÑË°åÔºàÁ¨¨ ${startRowIndex + 1} Ë°åÔºâË∂ÖÂá∫ÁØÑÂúç„ÄÇ`\n        });\n        return;\n      }\n      const newFormattedData = memoizedProcessor(jsonData, startRowIndex);\n      setFormattedData(newFormattedData);\n      setSuccessMessage('ËôïÁêÜÂÆåÊàêÔºÅÊÇ®ÁèæÂú®ÂèØ‰ª•‰∏ãËºâÊ™îÊ°à„ÄÇ');\n\n      // Scroll to output\n      if (outputRef.current) {\n        outputRef.current.scrollIntoView({\n          behavior: 'smooth'\n        });\n      }\n    } catch (error) {\n      setErrors({\n        file: 'ËôïÁêÜÈÅéÁ®ã‰∏≠Âá∫ÁèæÈåØË™§ÔºåË´ãÊ™¢Êü•ÊÇ®ÁöÑ Excel Ê™îÊ°àÊ†ºÂºè„ÄÇ'\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n  const readFile = file => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = e => resolve(e.target.result);\n      reader.onerror = error => reject(error);\n      reader.readAsArrayBuffer(file);\n    });\n  };\n  const handleDownload = () => {\n    const text = formattedData.join('\\n\\n------------------------\\n\\n');\n    const blob = new Blob([text], {\n      type: 'text/plain;charset=utf-8'\n    });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(blob);\n    link.download = 'formatted_data.txt';\n    link.click();\n    URL.revokeObjectURL(link.href);\n\n    // Show success animation\n    setSuccessMessage('Ê™îÊ°àÂ∑≤ÊàêÂäü‰∏ãËºâÔºÅ');\n    setTimeout(() => setSuccessMessage(''), 3000);\n  };\n  const handleCopyToClipboard = async () => {\n    const text = formattedData.join('\\n\\n------------------------\\n\\n');\n    try {\n      await navigator.clipboard.writeText(text);\n      setSuccessMessage('Â∑≤Ë§áË£ΩÂà∞Ââ™Ë≤ºÊùøÔºÅ');\n      setTimeout(() => setSuccessMessage(''), 3000);\n    } catch (err) {\n      setErrors({\n        clipboard: 'Ë§áË£ΩÂ§±ÊïóÔºåË´ãÊâãÂãïË§áË£Ω„ÄÇ'\n      });\n    }\n  };\n  const handlePreview = async () => {\n    if (!fileInputRef.current.files.length) return;\n    const file = fileInputRef.current.files[0];\n    const data = await readFile(file);\n    const workbook = XLSX.read(data, {\n      type: 'array'\n    });\n    const sheetName = workbook.SheetNames[0];\n    const worksheet = workbook.Sheets[sheetName];\n    const jsonData = XLSX.utils.sheet_to_json(worksheet, {\n      header: 1\n    });\n    setPreviewData(jsonData.slice(0, 5)); // Show first 5 rows\n  };\n  const resetAll = () => {\n    fileInputRef.current.value = '';\n    setStartNumber('');\n    setOffset('');\n    setFormattedData([]);\n    setPreviewData(null);\n    setErrors({});\n    setSuccessMessage('');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Momi \\u683C\\u5F0F\\u8F49\\u63DB\\u5668\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `drop-zone ${dragActive ? 'active' : ''}`,\n      onDragEnter: handleDrag,\n      onDragLeave: handleDrag,\n      onDragOver: handleDrag,\n      onDrop: handleDrop,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"drop-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-file-upload\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u62D6\\u653E Excel \\u6A94\\u6848\\u81F3\\u6B64\\u6216\\u9EDE\\u64CA\\u9078\\u64C7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"file-types\",\n          children: \"\\u652F\\u63F4\\u683C\\u5F0F: .xlsx, .xls\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        id: \"file-input\",\n        multiple: true,\n        type: \"file\",\n        ref: fileInputRef,\n        accept: \".xlsx, .xls\",\n        onChange: () => setErrors(prev => ({\n          ...prev,\n          file: ''\n        }))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }, this), errors.file && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-message\",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-exclamation-circle\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 13\n        }, this), errors.file]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"input-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-sort-numeric-down button-icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }, this), \"\\u8D77\\u59CB\\u6578\\u5B57\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        value: startNumber,\n        onChange: e => {\n          setStartNumber(e.target.value);\n          setErrors(prev => ({\n            ...prev,\n            startNumber: ''\n          }));\n        },\n        placeholder: \"\\u8ACB\\u8F38\\u5165\\u8D77\\u59CB\\u6578\\u5B57\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }, this), errors.startNumber && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-message\",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-exclamation-circle\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 13\n        }, this), errors.startNumber]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"input-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-arrows-alt-v button-icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this), \"\\u504F\\u79FB\\u503C\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        value: offset,\n        onChange: e => {\n          setOffset(e.target.value);\n          setErrors(prev => ({\n            ...prev,\n            offset: ''\n          }));\n        },\n        placeholder: \"\\u8ACB\\u8F38\\u5165\\u504F\\u79FB\\u503C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this), errors.offset && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-message\",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-exclamation-circle\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 13\n        }, this), errors.offset]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"process-btn\",\n      onClick: handleProcess,\n      disabled: loading,\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: `fas ${loading ? 'fa-spinner fa-spin' : 'fa-file-import'} button-icon`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 9\n      }, this), loading ? 'ËôïÁêÜ‰∏≠...' : 'ËôïÁêÜÊ™îÊ°à']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 7\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"progress-bar\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"progress-bar-fill\",\n        style: {\n          width: `${progress}%`\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 9\n    }, this), successMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"success-message\",\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-check-circle\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 11\n      }, this), successMessage]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 9\n    }, this), formattedData.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: outputRef,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"output-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-file-alt button-icon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 15\n          }, this), \"\\u8655\\u7406\\u7D50\\u679C\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"copy-btn\",\n          onClick: handleCopyToClipboard,\n          title: \"\\u8907\\u88FD\\u5230\\u526A\\u8CBC\\u677F\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-copy\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"output\",\n        children: formattedData.join('\\n\\n------------------------\\n\\n')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"download-btn\",\n        onClick: handleDownload,\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-download button-icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 13\n        }, this), \"\\u4E0B\\u8F09\\u6A94\\u6848\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 9\n    }, this), previewData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"preview-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-eye button-icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 13\n        }, this), \"\\u6A94\\u6848\\u9810\\u89BD (\\u524D5\\u884C)\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"preview-table\",\n        children: previewData.map((row, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"preview-row\",\n          children: row.map((cell, cellIndex) => /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"preview-cell\",\n            children: cell || 'N/A'\n          }, cellIndex, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 19\n          }, this))\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 9\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      role: \"alert\",\n      \"aria-busy\": \"true\",\n      className: \"sr-only\",\n      children: \"\\u8655\\u7406\\u9032\\u884C\\u4E2D\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 19\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"reset-btn\",\n      onClick: resetAll,\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-undo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this), \"\\u91CD\\u7F6E\\u6240\\u6709\\u8A2D\\u5B9A\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 195,\n    columnNumber: 5\n  }, this);\n};\n_s(Momi, \"JQ4pnNVW1xIr2zAxAHWDgge+jLM=\");\n_c = Momi;\nexport default Momi;\nvar _c;\n$RefreshReg$(_c, \"Momi\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","XLSX","jsxDEV","_jsxDEV","Momi","_s","formattedData","setFormattedData","startNumber","setStartNumber","offset","setOffset","loading","setLoading","errors","setErrors","successMessage","setSuccessMessage","dragActive","setDragActive","progress","setProgress","fileInputRef","outputRef","previewData","setPreviewData","interval","setInterval","prev","Math","min","clearInterval","setTimeout","file","timer","clearTimeout","validateInputs","newErrors","current","files","length","Number","isInteger","Object","keys","handleDrag","e","preventDefault","stopPropagation","type","handleDrop","dataTransfer","isValidFileType","fileName","some","ext","endsWith","includes","name","memoizedProcessor","jsonData","startRowIndex","processRow","row","index","currentNumber","parseInt","slice","map","handleProcess","data","readFile","workbook","read","sheetName","SheetNames","worksheet","Sheets","utils","sheet_to_json","header","newFormattedData","scrollIntoView","behavior","error","Promise","resolve","reject","reader","FileReader","onload","target","result","onerror","readAsArrayBuffer","handleDownload","text","join","blob","Blob","link","document","createElement","href","URL","createObjectURL","download","click","revokeObjectURL","handleCopyToClipboard","navigator","clipboard","writeText","err","handlePreview","resetAll","value","className","children","_jsxFileName","lineNumber","columnNumber","onDragEnter","onDragLeave","onDragOver","onDrop","id","multiple","ref","accept","onChange","placeholder","onClick","disabled","style","width","title","cell","cellIndex","role","_c","$RefreshReg$"],"sources":["C:/Users/gary/Downloads/html/src/components/Momi.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport * as XLSX from 'xlsx';\nimport './Momi.css';\n\nconst Momi = () => {\n  const [formattedData, setFormattedData] = useState([]);\n  const [startNumber, setStartNumber] = useState('');\n  const [offset, setOffset] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [errors, setErrors] = useState({});\n  const [successMessage, setSuccessMessage] = useState('');\n  const [dragActive, setDragActive] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const fileInputRef = useRef(null);\n  const outputRef = useRef(null);\n  const [previewData, setPreviewData] = useState(null);\n\n  useEffect(() => {\n    let interval;\n    if (loading) {\n      interval = setInterval(() => {\n        setProgress(prev => Math.min(prev + 10, 90));\n      }, 200);\n    }\n    return () => {\n      clearInterval(interval);\n      if (!loading && progress < 100) {\n        setProgress(100);\n        setTimeout(() => setProgress(0), 500);\n      }\n    };\n  }, [loading, progress]);\n\n  useEffect(() => {\n    if (errors.file || errors.startNumber || errors.offset) {\n      const timer = setTimeout(() => setErrors({}), 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [errors]);\n\n  useEffect(() => {\n    if (startNumber && offset) {\n      validateInputs();\n    }\n  }, [startNumber, offset, validateInputs]);\n\n  const validateInputs = useCallback(() => {\n    const newErrors = {};\n    if (!fileInputRef.current.files.length) {\n      newErrors.file = 'Ë´ãÈÅ∏Êìá‰∏ÄÂÄã Excel Ê™îÊ°à„ÄÇ';\n    }\n    if (!Number.isInteger(Number(startNumber)) || startNumber < 1) {\n      newErrors.startNumber = 'Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÊ≠£Êï¥Êï∏„ÄÇ';\n    }\n    if (!Number.isInteger(Number(offset)) || offset < 0) {\n      newErrors.offset = 'Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÈùûË≤†Êï¥Êï∏„ÄÇ';\n    }\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  }, [startNumber, offset]);\n\n  const handleDrag = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\n      setDragActive(true);\n    } else if (e.type === \"dragleave\") {\n      setDragActive(false);\n    }\n  };\n\n  const handleDrop = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n    \n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      const file = e.dataTransfer.files[0];\n      const isValidFileType = (fileName) => \n        ['.xlsx', '.xls', 'application/vnd.ms-excel', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet']\n          .some(ext => fileName.endsWith(ext) || file.type.includes(ext));\n\n      if (isValidFileType(file.name)) {\n        fileInputRef.current.files = e.dataTransfer.files;\n        setErrors(prev => ({ ...prev, file: '' }));\n      } else {\n        setErrors(prev => ({ ...prev, file: 'Ë´ã‰∏äÂÇ≥ Excel Ê™îÊ°à (.xlsx Êàñ .xls)' }));\n      }\n    }\n  };\n\n  const memoizedProcessor = useCallback((jsonData, startRowIndex) => {\n    const processRow = (row, index) => {\n      const currentNumber = parseInt(startNumber) + index;\n      return `üêçüêçÊñ∞Âπ¥Âø´Ê®Çü•∞üéÜüéÜüéÜüéÜ\\n\\nÁ¨¨${currentNumber}‰ΩçÊäïÁ®ø‰∫∫ÂöüÂï¶ÔΩû\\nÂêçÂ≠óÔºö${row[1] || 'N/A'}\\nÂπ¥ÈΩ°Ôºö${row[2] || 'N/A'}\\nË∫´È´òÔºö${row[3] || 'N/A'}\\n\\nÊèèËø∞Ëá™Â∑≤Ôºö${row[4] || 'N/A'}\\n\\nË¶ÅÊ±ÇÔºö${row[5] || 'N/A'}\\n\\nËÅØÁµ°ÊñπÂºèÔºö${row[6] || 'N/A'}\\n\\nÂ¶ÇÊûúÊúâÁ∑£‰∫∫ÊÉ≥Ë™çË≠òÁÑ°ÁïôtgÊó¢ÊäïÁ®ø‰∫∫ÔºåÂèØ‰ª•dmÂπ≥Âè∞ÁöÑÔºÅüôäüôäüôäüôäüôä\\nÊäïÁ®ølink‰øÇ‰∏ªÈ†Åüß®Â§ßÂÆ∂Èö®ÊÑèÊäïÁ®øüéê\\n\\n`;\n    };\n    return jsonData.slice(startRowIndex).map((row, index) => processRow(row, index));\n  }, [startNumber]);\n\n  const handleProcess = async () => {\n    if (!validateInputs()) return;\n\n    setLoading(true);\n    setSuccessMessage('');\n    setProgress(0);\n    \n    try {\n      const file = fileInputRef.current.files[0];\n      const data = await readFile(file);\n      const workbook = XLSX.read(data, { type: 'array' });\n      const sheetName = workbook.SheetNames[0];\n      const worksheet = workbook.Sheets[sheetName];\n      const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n\n      const startRowIndex = parseInt(startNumber) + parseInt(offset) - 1;\n      if (startRowIndex >= jsonData.length) {\n        setErrors({ file: `Ëµ∑ÂßãÊï∏Â≠óÂä†ÂÅèÁßªÂÄºÊåáÂêëÁöÑË°åÔºàÁ¨¨ ${startRowIndex + 1} Ë°åÔºâË∂ÖÂá∫ÁØÑÂúç„ÄÇ` });\n        return;\n      }\n\n      const newFormattedData = memoizedProcessor(jsonData, startRowIndex);\n\n      setFormattedData(newFormattedData);\n      setSuccessMessage('ËôïÁêÜÂÆåÊàêÔºÅÊÇ®ÁèæÂú®ÂèØ‰ª•‰∏ãËºâÊ™îÊ°à„ÄÇ');\n      \n      // Scroll to output\n      if (outputRef.current) {\n        outputRef.current.scrollIntoView({ behavior: 'smooth' });\n      }\n    } catch (error) {\n      setErrors({ file: 'ËôïÁêÜÈÅéÁ®ã‰∏≠Âá∫ÁèæÈåØË™§ÔºåË´ãÊ™¢Êü•ÊÇ®ÁöÑ Excel Ê™îÊ°àÊ†ºÂºè„ÄÇ' });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const readFile = (file) => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = (e) => resolve(e.target.result);\n      reader.onerror = (error) => reject(error);\n      reader.readAsArrayBuffer(file);\n    });\n  };\n\n  const handleDownload = () => {\n    const text = formattedData.join('\\n\\n------------------------\\n\\n');\n    const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(blob);\n    link.download = 'formatted_data.txt';\n    link.click();\n    URL.revokeObjectURL(link.href);\n\n    // Show success animation\n    setSuccessMessage('Ê™îÊ°àÂ∑≤ÊàêÂäü‰∏ãËºâÔºÅ');\n    setTimeout(() => setSuccessMessage(''), 3000);\n  };\n\n  const handleCopyToClipboard = async () => {\n    const text = formattedData.join('\\n\\n------------------------\\n\\n');\n    try {\n      await navigator.clipboard.writeText(text);\n      setSuccessMessage('Â∑≤Ë§áË£ΩÂà∞Ââ™Ë≤ºÊùøÔºÅ');\n      setTimeout(() => setSuccessMessage(''), 3000);\n    } catch (err) {\n      setErrors({ clipboard: 'Ë§áË£ΩÂ§±ÊïóÔºåË´ãÊâãÂãïË§áË£Ω„ÄÇ' });\n    }\n  };\n\n  const handlePreview = async () => {\n    if (!fileInputRef.current.files.length) return;\n    \n    const file = fileInputRef.current.files[0];\n    const data = await readFile(file);\n    const workbook = XLSX.read(data, { type: 'array' });\n    const sheetName = workbook.SheetNames[0];\n    const worksheet = workbook.Sheets[sheetName];\n    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n    \n    setPreviewData(jsonData.slice(0, 5)); // Show first 5 rows\n  };\n\n  const resetAll = () => {\n    fileInputRef.current.value = '';\n    setStartNumber('');\n    setOffset('');\n    setFormattedData([]);\n    setPreviewData(null);\n    setErrors({});\n    setSuccessMessage('');\n  };\n\n  return (\n    <div className=\"container\">\n      <h1>Momi Ê†ºÂºèËΩâÊèõÂô®</h1>\n      \n      <div \n        className={`drop-zone ${dragActive ? 'active' : ''}`}\n        onDragEnter={handleDrag}\n        onDragLeave={handleDrag}\n        onDragOver={handleDrag}\n        onDrop={handleDrop}\n      >\n        <div className=\"drop-content\">\n          <i className=\"fas fa-file-upload\"></i>\n          <p>ÊãñÊîæ Excel Ê™îÊ°àËá≥Ê≠§ÊàñÈªûÊìäÈÅ∏Êìá</p>\n          <p className=\"file-types\">ÊîØÊè¥Ê†ºÂºè: .xlsx, .xls</p>\n        </div>\n        <input \n          id=\"file-input\"\n          multiple\n          type=\"file\"\n          ref={fileInputRef}\n          accept=\".xlsx, .xls\"\n          onChange={() => setErrors(prev => ({ ...prev, file: '' }))}\n        />\n        {errors.file && (\n          <div className=\"error-message\">\n            <i className=\"fas fa-exclamation-circle\"></i>\n            {errors.file}\n          </div>\n        )}\n      </div>\n\n      <div className=\"input-group\">\n        <label>\n          <i className=\"fas fa-sort-numeric-down button-icon\"></i>\n          Ëµ∑ÂßãÊï∏Â≠ó\n        </label>\n        <input\n          type=\"number\"\n          value={startNumber}\n          onChange={(e) => {\n            setStartNumber(e.target.value);\n            setErrors(prev => ({ ...prev, startNumber: '' }));\n          }}\n          placeholder=\"Ë´ãËº∏ÂÖ•Ëµ∑ÂßãÊï∏Â≠ó\"\n        />\n        {errors.startNumber && (\n          <div className=\"error-message\">\n            <i className=\"fas fa-exclamation-circle\"></i>\n            {errors.startNumber}\n          </div>\n        )}\n      </div>\n\n      <div className=\"input-group\">\n        <label>\n          <i className=\"fas fa-arrows-alt-v button-icon\"></i>\n          ÂÅèÁßªÂÄº\n        </label>\n        <input\n          type=\"number\"\n          value={offset}\n          onChange={(e) => {\n            setOffset(e.target.value);\n            setErrors(prev => ({ ...prev, offset: '' }));\n          }}\n          placeholder=\"Ë´ãËº∏ÂÖ•ÂÅèÁßªÂÄº\"\n        />\n        {errors.offset && (\n          <div className=\"error-message\">\n            <i className=\"fas fa-exclamation-circle\"></i>\n            {errors.offset}\n          </div>\n        )}\n      </div>\n\n      <button \n        className=\"process-btn\" \n        onClick={handleProcess} \n        disabled={loading}\n      >\n        <i className={`fas ${loading ? 'fa-spinner fa-spin' : 'fa-file-import'} button-icon`}></i>\n        {loading ? 'ËôïÁêÜ‰∏≠...' : 'ËôïÁêÜÊ™îÊ°à'}\n      </button>\n\n      {loading && (\n        <div className=\"progress-bar\">\n          <div \n            className=\"progress-bar-fill\" \n            style={{ width: `${progress}%` }}\n          ></div>\n        </div>\n      )}\n\n      {successMessage && (\n        <div className=\"success-message\">\n          <i className=\"fas fa-check-circle\"></i>\n          {successMessage}\n        </div>\n      )}\n\n      {formattedData.length > 0 && (\n        <div ref={outputRef}>\n          <div className=\"output-header\">\n            <h3>\n              <i className=\"fas fa-file-alt button-icon\"></i>\n              ËôïÁêÜÁµêÊûú\n            </h3>\n            <button \n              className=\"copy-btn\"\n              onClick={handleCopyToClipboard}\n              title=\"Ë§áË£ΩÂà∞Ââ™Ë≤ºÊùø\"\n            >\n              <i className=\"fas fa-copy\"></i>\n            </button>\n          </div>\n          <div className=\"output\">\n            {formattedData.join('\\n\\n------------------------\\n\\n')}\n          </div>\n          <button className=\"download-btn\" onClick={handleDownload}>\n            <i className=\"fas fa-download button-icon\"></i>\n            ‰∏ãËºâÊ™îÊ°à\n          </button>\n        </div>\n      )}\n\n      {previewData && (\n        <div className=\"preview-section\">\n          <h3>\n            <i className=\"fas fa-eye button-icon\"></i>\n            Ê™îÊ°àÈ†êË¶Ω (Ââç5Ë°å)\n          </h3>\n          <div className=\"preview-table\">\n            {previewData.map((row, index) => (\n              <div key={index} className=\"preview-row\">\n                {row.map((cell, cellIndex) => (\n                  <span key={cellIndex} className=\"preview-cell\">\n                    {cell || 'N/A'}\n                  </span>\n                ))}\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {loading && <div role=\"alert\" aria-busy=\"true\" className=\"sr-only\">ËôïÁêÜÈÄ≤Ë°å‰∏≠</div>}\n\n      <button className=\"reset-btn\" onClick={resetAll}>\n        <i className=\"fas fa-undo\"></i>\n        ÈáçÁΩÆÊâÄÊúâË®≠ÂÆö\n      </button>\n    </div>\n  );\n};\n\nexport default Momi;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}